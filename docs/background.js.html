<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: background.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: background.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import Vue from "vue";
import Vuex from "vuex";
import VuexWebExtensions from "vuex-webextensions";
import user from "@/store/modules/user";
import player from "@/store/modules/player";
import spotify from "@/store/modules/spotify";
import VuexPersistence from "vuex-persist";
import browser from "webextension-polyfill";
import { initialize } from "@/spotifyPlayer";
import toastMessage from "@/store/modules/toastMessage";

/**
 * @module background
 * @desc Background script where player is initialized
 */

window.onSpotifyWebPlaybackSDKReady = () => {};
Vue.use(Vuex);
const debug = process.env.NODE_ENV !== "production";

/**
 * @param {} vuexLocal
 * @desc cerate VuexPersistance to map store to localStorage
 */
const vuexLocal = new VuexPersistence({
  storage: window.localStorage,
  key: "spotifix-plugin",
  strictMode: true,
});

/**
 * @param {} store
 * @desc cerate Vuex store instance
 */
const store = new Vuex.Store({
  modules: {
    user,
    player,
    spotify,
    toastMessage,
  },
  mutations: {
    RESTORE_MUTATION: vuexLocal.RESTORE_MUTATION, // this mutation **MUST** be named "RESTORE_MUTATION"
  },
  strict: true,
  plugins: [
    vuexLocal.plugin,
    VuexWebExtensions({
      syncActions: false,
    }),
  ],
});

Vue.prototype.$store = store;
store.dispatch("user/login", false);
store.subscribe((mutation, state) => {
  if (mutation.type === "user/SAVE_TOKEN") {
    initialize();
  }
});
initialize();

/**
 * @desc Catch messages from popup and call function from store by dispatch
 */
browser.runtime.onMessage.addListener((request) => {
  if (request.type === "player") {
    store.dispatch(request.msg, request.value ? request.value : null);
  }
});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-Api.html">Api</a></li><li><a href="module-background.html">background</a></li><li><a href="module-components_albums.html">components/albums</a></li><li><a href="module-components_artists.html">components/artists</a></li><li><a href="module-components_player.html">components/player</a></li><li><a href="module-components_tracks.html">components/tracks</a></li><li><a href="module-components_userInfo.html">components/userInfo</a></li><li><a href="module-popup_App.html">popup/App</a></li><li><a href="module-popup_main.html">popup/main</a></li><li><a href="module-spotify.html">spotify</a></li><li><a href="module-spotifyPlayer.html">spotifyPlayer</a></li><li><a href="module-store_modules_player.html">store/modules/player</a></li><li><a href="module-store_modules_spotify.html">store/modules/spotify</a></li><li><a href="module-store_modules_toastMessage.html">store/modules/toastMessage</a></li><li><a href="module-store_modules_user.html">store/modules/user</a></li><li><a href="module-store_mutation-types.html">store/mutation-types</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.4</a> on Tue May 05 2020 11:34:25 GMT+0200 (Central European Summer Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
